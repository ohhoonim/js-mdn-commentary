{
    "cells": [
        {
            "language": "markdown",
            "source": [
                "# Generator\n\nğŸ”— [iterator & generator](https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Iterators_and_Generators)"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "## ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œì˜ iterator(ë°˜ë³µì) íƒ€ì…ì´ë€\n\nìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ iterator íƒ€ì…ì€ next() ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ê³ , next() ë©”ì„œë“œëŠ” {value: \"\", done: \"\"} ê°ì²´ë¥¼ ë¦¬í„´í•œë‹¤. \n\nğŸ”— [MDN iterator protocal ì •ì˜](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#the_iterator_protocol)\n\n**ì°¸ê³ ** ì†ŒìŠ¤ê°€ ë³¸ í™•ì¥íˆ´ì—ì„œëŠ” ì •ìƒë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. "
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "const iter = {\n    next: function() {\n        return {value: undefined , done: false};\n    }\n};"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "function makeRangeIterator(start = 0, end = Infinity, step = 1) {\n    var nextIndex = start;\n    var n = 0;\n\n    var rangeIterator = {\n       next: function() {\n           var result;\n           if (nextIndex < end) {\n               result = { value: nextIndex, done: false }\n           } else if (nextIndex == end) {\n               result = { value: n, done: true }\n           } else {\n               result = { done: true };\n           }\n           nextIndex += step;\n           n++;\n           return result;\n       }\n    };\n    return rangeIterator;\n}\n// makeRangeIterator(1, 2, 5);"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "let iter = makeRangeIterator(1, 18, 3);\n\nlet result = iter.next();\nwhile (!result.done) {\n   console.log(result.value);\n   result = iter.next();\n}"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "iterator(ë°˜ë³µì)ë¥¼ ì˜ ì‚¬ìš©í•˜ë©´ ìœ ìš©í•˜ì§€ë§Œ, ë‚´ë¶€ì ìœ¼ë¡œ ìƒíƒœë¥¼ ìœ ì§€í•´ì•¼í•˜ë¯€ë¡œ ì£¼ì˜í•´ì„œ ì‚¬ìš©í•´ì•¼í•œë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤. "
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "## generatorí•¨ìˆ˜ì˜ function* ë¬¸ë²• \n\ngenerator í•¨ìˆ˜ëŠ” 'function*' ë¬¸ë²•ì„ ì‚¬ìš©í•˜ì—¬ ì‘ì„±ëœë‹¤. ìµœì´ˆ í˜¸ì¶œì‹œ ì–´ë–¤ ì½”ë“œë„ ì‹¤í–‰ë˜ì§€ ì•Šê³  iteratoríƒ€ì…ì„ ë°˜í™˜í•œë‹¤. "
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "function* abcGen() {\n    yield 'a';\n    yield 'b';\n    yield 'c';\n}\n\nconst abc = abcGen();\n\nconsole.log(abc.next());\nconsole.log(abc.next());\nconsole.log(abc.next());\nconsole.log(abc.next());\n"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "ì•ì„œ ì‘ì„±í–ˆë˜ iteratorë¥¼ generatorë¡œ êµ¬í˜„í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. "
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "function* makeRangeGenerator(start = 0, end = Infinity, step = 1) {\n    let n = 0;\n    for (let i = start; i < end; i += step) {\n        n++;\n        yield i;\n    }\n    return n;\n}\n\nconst rangeGenerator = makeRangeGenerator(1, 10, 3);\n\nconsole.log(rangeGenerator.next());\nconsole.log(rangeGenerator.next());\nconsole.log(rangeGenerator.next());\nconsole.log(rangeGenerator.next());"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "next() ë©”ì„œë“œì— íŒŒë¼ë¯¸í„°ë¡œ ê°’ì„ ì „ë‹¬í•  ìˆ˜ ë„ ìˆìŠµë‹ˆë‹¤. "
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "function* makeRangeGenerator3(start , end, step) {\n    let n = 0;\n    for (let i = start; i < end; i += step) {\n        n++;\n        let isBreak = yield i;\n        // console.log(isBreak);\n        if (isBreak === true) {\n            break;\n        }\n    }\n\n    return n;\n}"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "\nconst rangeGenerator3 = makeRangeGenerator3(1, 20, 2);\n\nconsole.log(rangeGenerator3.next());\nconsole.log(rangeGenerator3.next());\nconsole.log(rangeGenerator3.next());\nconsole.log(rangeGenerator3.next());\nconsole.log(rangeGenerator3.next(false));\nconsole.log(rangeGenerator3.next());\nconsole.log(rangeGenerator3.next());\nconsole.log(rangeGenerator3.next());\nconsole.log(rangeGenerator3.next());"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "return() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ íŒŒë¼ë¯¸í„°ë¡œ value ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. "
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "const rangeGenerator4 = makeRangeGenerator3(1, 10, 2);\n\nconsole.log(rangeGenerator4.next());\nconsole.log(rangeGenerator4.next());\nconsole.log(rangeGenerator4.next());\nconsole.log(rangeGenerator4.next());\nconsole.log(rangeGenerator4.next());\nconsole.log(rangeGenerator4.next());\nconsole.log(rangeGenerator4.next());\nconsole.log(rangeGenerator4.return(\"ì¢…ë£Œ\"));\nconsole.log(rangeGenerator4.next());"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "## generatorì˜ í™œìš©\n\n- custom iterables\n- lazy/infinite sequences\n- state machines\n- data processing\n- data streams"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "## í™œìš©ì˜ˆì œ1 - UUID ìƒì„±ê¸°"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "function* UUIDGenerator() {\n    let d, r;\n    while(true) {\n        yield 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            r = (new Date().getTime() + Math.random()*16)%16 | 0;\n            d = Math.floor(d/16);\n            return (c=='x' ? r : (r&0x3|0x8)).toString(16);\n        });\n    }\n};"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "const uuid = UUIDGenerator();\n\nfor (let i = 0; i < 100; i++) {\n    let result = uuid.next().value;\n    console.log(result);\n}\n\nconsole.log(uuid.next());\nconsole.log(uuid.next());\nconsole.log(uuid.next());"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "## í™œìš©ì˜ˆì œ 2 - custom iterables"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "const cardDeck = ({\n    suits: [\"â™£ï¸\", \"â™¦ï¸\", \"â™¥ï¸\", \"â™ ï¸\"],\n    court: [\"J\", \"Q\", \"K\", \"A\"],\n    [Symbol.iterator]: function* () {\n      for (let suit of this.suits) {\n        for (let i = 2; i <= 10; i++) yield suit + i;\n        for (let c of this.court) yield suit + c;\n      }\n    }\n  })\n"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "[...cardDeck];"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "## í™œìš©ì˜ˆì œ 3 - ë¬´í•œ ìŠ¤í¬ë¡¤ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "getSwapiPagerator = (endpoint) =>\n  async function* () {\n    let nextUrl = `https://swapi.dev/api/${endpoint}`;\n    while (nextUrl) {\n      const response = await fetch(nextUrl);\n      const data = await response.json();\n      nextUrl = data.next;\n      yield* data.results;\n    }\n  }\n// Example adapted from Luciano Mammino's https://www.nodejsdesignpatterns.com/blog/javascript-async-iterators/"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "starWars = ({\n    characters: {\n      [Symbol.asyncIterator]: getSwapiPagerator(\"people\")\n    },\n    planets: {\n      [Symbol.asyncIterator]: getSwapiPagerator(\"planets\")\n    },\n    ships: {\n      [Symbol.asyncIterator]: getSwapiPagerator(\"starships\")\n    }\n  })"
            ],
            "outputs": []
        },
        {
            "language": "javascript",
            "source": [
                "{\n    const results = [];\n    for await (const page of starWars.ships) {\n      console.log(page.name);\n      results.push(page.name);\n      yield results;\n    }\n  }"
            ],
            "outputs": []
        }
    ]
}